<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>注册 / Signup | RavelloH's Blog</title>

    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta name="author" content="RavelloH" />
    <meta name="pagetype" content="platform" />
    <meta name="theme-color" content="#111111" />
    <meta property="og:title" content="注册 / Signup | RavelloH's Blog" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://ravelloh.top/platform/signup/index.html" />
    <meta property="og:image" content="https://ravelloh.top/assets/images/apple-touch-icon.png" />
    <!-- Preload -->
    <link rel="preload" href="/assets/fonts/ri.woff2" as="font" crossorigin>
    <link rel="preload" href="/assets/fonts/Furore.ttf" as="font" crossorigin>
    <link rel="preload" href="/assets/js/script.js" as="script">
    <link rel="preload" href="/assets/js/i18n.js" as="script">
    <link rel="preload" href="/assets/js/moudle.js" as="script">
    <link rel="preload" href="/assets/js/display.js" as="script">
    <link rel="preload" href="/assets/css/style.css" as="style">
    <link rel="preload" href="/assets/css/iconfont.css" as="style">
    <link rel="preload" href="/assets/images/avatar.jpg" as="image">

    <!-- Loading Starter -->
    <script defer type="text/javascript" src="/assets/js/loading.js"></script>
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/style.css" type="text/css" media="all">
    <link rel="stylesheet" href="/assets/css/iconfont.css" type="text/css">
    <noscript>
        <style type="text/css" media="all">
            .loading {
                opacity: 1;
                transition: 0.5s;
            }

            #load-shade {
                display: none;
            }
        </style>
    </noscript>
    <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/assets/images/apple-touch-icon.png" type="image/png">
    <link rel="apple-touch-icon-precomposed" href="/assets/images/favicon-32x32.png" type="image/png">
    <link rel="icon" href="/favicon.ico">
    <link rel="manifest" href="/site.webmanifest">
</head>

<body>
    <!-- viewport start -->
    <section id="showcase">
        <div id="shade-global"></div>
        <div id="load-shade" class="active">
            <div id="load-content">
                <hr>
                <h2>RavelloH's Blog</h2>
                <h3>LOAD <span id="loading-text"> ing <span class="breath"> <span>.</span> <span>.</span> <span>.</span> </span> </span></h3>
                <hr> <br>
            </div>
        </div>
        <header>
            <div id="logo" class="loading" style="--i: 1">
                <!-- logo start -->
                <a href="#userbar">
                    <img id="avatar" class="no-zoom" src="/assets/images/avatar.jpg" alt="avatar">
                    <img id="avatarname" class="no-zoom" src="/assets/images/RavelloH.svg" alt="RavelloH's Blog">
                </a>
                <!-- logo end -->
            </div>
            <div id="header-side">
                <div id="navs">
                    <!-- nav start -->
                    <nav>
                        <a href="/" class="loading" style="--i: 5" id="nav-home">HOME</a>
                        <a href="/works/" class="loading" style="--i: 4" id="nav-works"> WORKS </a>
                        <a href="/articles/" class="loading" style="--i: 3" id="nav-articles"> ARTICLES </a>
                        <a href="/friends/" class="loading" style="--i: 2" id="nav-friends"> FRIENDS </a>
                        <a href="/about/" class="loading" style="--i: 1" id="nav-about"> ABOUT </a>
                    </nav>
                    <!-- nav end -->
                </div>
                <div id="toggle" class="loading" style="--i: 0"></div>
            </div>
        </header>
        <div id="shade-context"></div>
        <div id="main" class="loading">
            <div id="viewmap">
                <div class="texts overflow half" style='--i: 0'>
    <br><br>
    <div id="signup-form">
        <div class="form-control">
            <input type="text" required="true" id="signup-username" minlength="2" maxlength="10" oninput="checkUsername()" onpropertychange="checkUsername()">
            <label><span class="i_small ri:user-3-line" style="--i: 0;">&nbsp;</span>
                <span id="username-tip" style="--i: 1">
                    <div>
                        用户名 - Username
                    </div>
                </span>
            </label>
        </div>

        <div class="form-control">
            <input type="text" required="true" id="signup-email" oninput="checkEmail()" onpropertychange="checkEmail()">
            <label><span class="i_small ri:mail-line" style="--i: 0;">&nbsp;</span>
                <span style="--i: 1" id="email-tip">
                    <div>
                        邮箱 - Email
                    </div>
                </span>
            </label>
        </div>


        <div class="form-control">
            <input type="password" required="true" oninput="checkPassword()" onpropertychange="checkPassword()" id="signup-password">
            <label><span class="i_small ri:lock-password-line" style="--i: 0;">&nbsp;</span><span style="--i: 1" id="password-tip">
                    <div>
                        密码 / Password
                    </div>
                </span>
            </label>
        </div>


        <div class="checkbox">
            <label class="checkbox-label">
                <input type="checkbox" class="checkbox-input" id="check-allow-send-messages" />
                <span class="checkbox-name"></span>
                允许向邮箱发送有关通知
            </label>
        </div>

        <div class="form-control">
            <div class="big-button block" id="signup-button">
                <span>
                    <span class="circle-loader"></span>
                </span>
            </div>
            <div class="flex-items">
                <span>已有账户？<a href="/platform/signin/">立即登录&gt;</a></span>

            </div>

        </div>

    </div>

</div>

<div class="placeholder">
</div>
<div class="texts overflow" style='--i: 0'>
    <br>
    <h4>Sign Up - 注册</h4>
    <h3>RPlatform.</h3>
    <span class="virgule">
        Platform Id: <span id="platform-id">Loading...</span>
    </span>
    <br>
    <p>
        RPlatform是一个开源的社区内容管理平台，<br>
        客户端可以通过各种API与相关接口交互，<br>
        因此任何静态站点都能轻松接入此平台，以获取丰富的在线可交互内容更新。<br>
        简洁、高效、安全，是此平台的设计初衷。<br>
        现在登入，即刻体验。
    </p>
    <p>
        我们使用现代加密算法Argon2id单向加盐以不可逆的处理密码，<br>
        并使用自研Shuffler函数对输入的密码进行乱序重组预处理，以保证你的账号安全。<br>
    </p>
</div>
            </div>
        </div>
        <footer>
            <div id="icons-left">
                <nav>
                    <a class="loading loaded" style="--i: 1" id="icon-about" href="#about" onclick="openInfoBar('info');return false;" aria-label="about this page" data-pjax-state="" data-umami-event="footer-关于"><span class="i ri:file-info-line"></span></a>
                    <a class="loading loaded" style="--i: 2" id="icon-github" href="http://github.com/ravelloh" target="_blank" rel="noreferrer" aria-label="my github" data-pjax-state="" data-umami-event="footer-Github"><span class="i ri:github-fill"></span></a>
                    <a class="loading loaded" style="--i: 3" id="icon-studio" href="http://xeocnet-studio.github.io" target="_blank" rel="noreferrer" aria-label="my studio" data-pjax-state="" data-umami-event="footer-工作室"><span class="i ri:building-2-line"></span></a>
                    <a class="loading loaded" style="--i: 4" id="icon-rss" onclick="openInfoBar('feed')" data-umami-event="footer-RSS"><span class="i ri:rss-fill"></span></a>
                </nav>
            </div>
            <div id="icons-right" class="loading loaded" style="--i: 1" data-umami-event="footer-消息栏">
                <div id="message-bar">
                    <noscript>
                        <a class="red" href="/about/help#javascript"><strong>错误:无法使用JAVASCRIPT</strong>&nbsp;<span class="i ri:alert-line"></span></a>
                    </noscript>
                </div>
            </div>
        </footer>
    </section>
    <section id="sidebar">
        <div id="sidebar-top">
            <div id="sideinfo">
                <h3>RavelloH's</h3>
                <h2>BLOG</h2>
                <a class="icons" href="mailto:ravelloh@outlook.com" id="email"> <span class="i ri:mail-add-fill"></span> &nbsp; <span>ravelloh@outlook.com</span> </a>
                <hr>
            </div>
        </div>
        <div id="sidebar-mid">
            <menu id="sidebar-menu">
                <ul>
                    <!-- menu start -->
                    <li style="--i: 1"><a href="/"><span class="i_small ri:home-3-fill"></span> HOME</a></li>
                    <li style="--i: 2"><a href="/works/"><span class="i_small ri:dashboard-fill"></span> WORKS</a></li>
                    <li style="--i: 3"><a href="/articles/"><span class="i_small ri:article-fill"></span> ARTICLES</a></li>
                    <li style="--i: 4"><a href="/images/"><span class="i_small ri:image-fill"></span> IMAGES</a></li>
                    <li style="--i: 4"><a href="/games/"><span class="i_small ri:gamepad-fill"></span> GAMES</a></li>
                    <li style="--i: 5"><a href="/friends/"><span class="i_small ri:team-fill"></span> FRIENDS</a></li>
                    <li style="--i: 6"><a href="/about/"><span class="i_small ri:information-fill"></span> ABOUT</a></li>
                    <li>&nbsp;</li>
                    <li><a href="/platform/signin/"><span class="i_small ri:login-box-fill"></span> LOG IN</a></li>
                    <li><a href="https://analytics.ravelloh.top/share/4kyzPMCCpfG9Vd1k/blog"><span class="i_small ri:bar-chart-box-fill"></span> ANALYTICS</a></li>
                    <li><a href="https://drive.ravelloh.top/"><span class="i_small ri:hard-drive-3-fill"></span> DRIVE</a></li>
                    <li><a href="https://monitor.ravelloh.top/"><span class="i_small ri:timer-flash-fill"></span> UPTIME</a></li>
                    <li><a href="/about/help/"><span class="i_small ri:questionnaire-fill"></span> HELP</a></li>
                    <!-- menu end -->
                </ul>
            </menu>
        </div>
        <div id="sidebar-bottom">
            <hr>
            <div id="side-info">
                <!-- side-info start -->
                <b>
                    Theme : <a href="https://github.com/ravelloh/RTheme">RTheme</a> . <br>
                    Powered by <a href="https://github.com/RavelloH/RenderBuild">RenderBuild</a> .<br>
                    Copyright © 2019 - <b id="year"></b> RavelloH. <br>
                    All rights reserved.
                </b>
                <!-- side-info end -->
            </div>
            <div class="flex-iconset">
                <ul>
                    <li><a href="#swap" id="icon-swap" onclick="openInfoBar('swap');return false;" aria-label="swap"> <span class="i ri:swap-box-line"></span> </a></li>
                    <li><a href="#" id="icon-color" onclick="toggleThemeMode();return false;" aria-label="color"> <span class="i ri:sun-line"></span> </a></li>
                    <li><a href="#music" id="icon-music" onclick="openInfoBar('music');return false;" aria-label="music"> <span class="i ri:file-music-line"></span> </a></li>
                    <li><a href="#" id="icon-fullscreen" onclick="toggleFullScreen();return false;" aria-label="fullscreen"> <span class="i ri:aspect-ratio-line"></span> </a></li>
                    <li><a href="#share" id="icon-share" onclick="openInfoBar('share');return false;" aria-label="share"> <span class="i ri:share-box-line"></span> </a></li>
                    <li><a href="#setting" id="icon-setting" onclick="openInfoBar('setting');return false;" aria-label="setting"> <span class="i ri:settings-4-line"></span> </a></li>
                </ul>
            </div>
        </div>
    </section>
    <section id="infobar">
        <div id="infobar-header">
            <div id="infobar-title">
                INFO
            </div>
            <div id="infobar-toggle">
                <span class="i ri:arrow-down-s-line"></span>
            </div>
        </div>
        <div id="infobar-context">
            <div id="infobar-left"></div>
            <div id="infobar-right">
                <h2 id="time">00:00</h2>
                <hr>
                <div id="music-player">
                    <div id="music-top">
                        <div id="music-name">
                            无正在播放的音乐
                        </div>
                        <div id="music-time">
                            00:00/00:00
                        </div>
                    </div>
                    <audio id="music" src="/" ontimeupdate="musicUpdata()" loop="loop" preload="none"></audio>
                    <div id="music-bar">
                        <div id="music-progress-container">
                            <div id="music-progress"></div>
                        </div>
                    </div>
                    <div id="music-operation">
                        <span onclick="musicSetting()"> <span class="i ri:play-list-line"></span> </span> <span class="i ri:skip-back-line" onclick="musicGo(-10)"></span> <span id="music-button" onclick="musicPlay()"> <span class="i ri:play-line"></span> </span> <span class="i ri:skip-forward-line" onclick="musicGo(10)"></span> <span class="i ri:repeat-one-line"></span>
                    </div>
                </div>
                <div id="state-bar"></div>
                <div id="uid" class="barcode center">
                    <br>
                </div>
            </div>
        </div>
    </section>
    <section id="userbar"></section>
    <!-- viewport end -->

    <!-- JavaScript -->
    <script defer type="text/javascript" src="/assets/js/i18n.js" onload="loadComplete('i18n.js')"></script>
    <script defer type="text/javascript" src="/assets/js/moudle.js" onload="loadComplete('moudle.js')"></script>
    <script defer type="text/javascript" src="/assets/js/script.js" onload="loadComplete('script.js')"></script>
    <script defer type="text/javascript" src="/assets/js/display.js" onload="loadComplete('display.js')"></script>
    <script defer type="text/javascript" src="/assets/js/pjax.js" onload="enablePjax();loadComplete('pjax.js')"></script>
    <script defer type="text/javascript" src="/assets/js/analysis.js" onload="baiduAnalysis();umamiAnalytics()"></script>
    <div id="page-js">
        <script>function main() {
    if (docCookies.getItem('usertoken')) {
        pjaxLoad(`/platform/user?uid=${token.read('uid')}`)
        return
    }
    fetch(`${platformUrl}api/check`)
        .then((response) => response.json())
        .then((data) => {
        if (data.code == 200) {
            switchElementContent('#platform-id', data.inner.id)
            document.querySelector('#signup-button')
                .classList.remove('block')
            document.querySelector('#signup-button')
                .onclick = () => (signin())
            switchElementContent('#signup-button span', '注册')
        } else {
            showError('平台运行异常，请稍后重试')
            switchElementContent('#signup-button span', '平台运行异常，刷新页面以重试')
            switchElementContent('#platform-id', 'ERROR')
            document.querySelector('#signup-button')
                .onclick = () => (pjaxLoad('#'))
        }
    })
        .
    catch ((e) => {
        showError('无法与注册服务器建立连接，请稍后重试', 12000)
        switchElementContent('#signup-button span', '刷新页面以重试')
        switchElementContent('#platform-id', 'ERROR')
        document.querySelector('#signup-button')
            .onclick = () => (pjaxLoad('#'))
    });
}

function signin() {
    switchElementContent('#signup-button span',
        '<span class="circle-loader"></span>')
    document.querySelector('#signup-button')
        .classList.add('block')
    document.querySelector('#signup-button')
        .onclick = null

    if (!document.querySelector('#signup-username')
        .value) {
        switchElementContent('#signup-button span',
            '请输入用户名')
        setTimeout(() => {
            document.querySelector('#signup-button')
                .classList.remove('block')
            document.querySelector('#signup-button')
                .onclick = () => (signin())
            switchElementContent('#signup-button span', '注册')
        }, 5000)
        return false
    }


    if (!document.querySelector('#signup-password')
        .value) {
        switchElementContent('#signup-button span',
            '请输入密码')
        setTimeout(() => {
            document.querySelector('#signup-button')
                .classList.remove('block')
            document.querySelector('#signup-button')
                .onclick = () => (signin())
            switchElementContent('#signup-button span', '注册')
        }, 5000)
        return false
    }

    if (!document.querySelector('#signup-email')
        .value) {
        switchElementContent('#signup-button span',
            '请输入邮箱')
        setTimeout(() => {
            document.querySelector('#signup-button')
                .classList.remove('block')
            document.querySelector('#signup-button')
                .onclick = () => (signin())
            switchElementContent('#signup-button span', '注册')
        }, 5000)
        return false
    }

    if (!checkEmail()) {
        switchElementContent('#signup-button span',
            '邮箱格式不正确')
        setTimeout(() => {
            document.querySelector('#signup-button')
                .classList.remove('block')
            document.querySelector('#signup-button')
                .onclick = () => (signin())
            switchElementContent('#signup-button span', '注册')
        }, 5000)
        return false
    }

    if (!checkUsername()) {
        switchElementContent('#signup-button span',
            '用户名格式不正确')
        setTimeout(() => {
            document.querySelector('#signup-button')
                .classList.remove('block')
            document.querySelector('#signup-button')
                .onclick = () => (signin())
            switchElementContent('#signup-button span', '注册')
        }, 5000)
        return false
    }

    if (!checkPassword()) {
        switchElementContent('#signup-button span',
            '密码格式不正确')
        setTimeout(() => {
            document.querySelector('#signup-button')
                .classList.remove('block')
            document.querySelector('#signup-button')
                .onclick = () => (signin())
            switchElementContent('#signup-button span', '注册')
        }, 5000)
        return false
    }


    fetch(platformUrl + 'api/signup', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: objectToForm({
            username: document.querySelector('#signup-username')
                .value,
            nickname: document.querySelector('#signup-username')
                .value,
            email: document.querySelector('#signup-email')
                .value,
            password: document.querySelector('#signup-password')
                .value,
            allowMessage: document.querySelector('#check-allow-send-messages')
                .checked
        }),
    })
        .then((response) => response.json())
        .then((data) => {
        if (data.code == 200) {
            switchElementContent('#signup-button span', '注册成功，即将跳转至登录')
            setTimeout(() => {
                if (analyzeURL(window.location.href, 'redirect') !== '') {
                    pjaxLoad('/platform/signin?redirect=' + analyzeURL(window.location.href, 'redirect'));
                } else {
                    pjaxLoad('/platform/signin')
                }
            },
            3000)
        } else {
            switchElementContent('#signup-button span', data.message)
        }
    })
        .
    catch ((e) => {
        console.error(e)
        switchElementContent('#signup-button span', '无法与注册服务器建立连接')
    })
        .
    finally(() => {
        setTimeout(() => {
            document.querySelector('#signup-button')
                .classList.remove('block')
            document.querySelector('#signup-button')
                .onclick = () => (signin())
            switchElementContent('#signup-button span', '注册')
        }, 5000)
    });
}

function checkPassword() {
    if (
    parseInt(document.querySelector('#signup-password')
        .value.length) < 6 || parseInt(document.querySelector('#signup-password')
        .value.length) > 4096) {
        // document.querySelector('#signup-password').setAttribute('invalid', '')
        switchElementContent('#password-tip div', '密码应介于6-4096位之间')
        return false
    }
    // document.querySelector('#signup-password').removeAttribute('invalid');
    switchElementContent('#password-tip div', '密码 / Password')
    return true

}

function checkUsername() {
    if (
    parseInt(document.querySelector('#signup-username')
        .value.length) < 5 || parseInt(document.querySelector('#signup-username')
        .value.length) > 10) {
        // document.querySelector('#signup-password').setAttribute('invalid', '')
        switchElementContent('#username-tip div', '用户名应介于5-10位之间')
        return false
    }
    if (!/^[a-z0-9_]+$/.test(document.querySelector('#signup-username')
        .value)) {
        switchElementContent('#username-tip div', '用户名应仅由英文小写字母及数字或下划线组成')
        return false
    }
    // document.querySelector('#signup-password').removeAttribute('invalid');
    switchElementContent('#username-tip div', '用户名 / Username')
    return true
}

function checkEmail() {
    if (!/\w[-\w.+]*@([A-Za-z0-9][-A-Za-z0-9]+\.)+[A-Za-z]{2,14}/.test(document.querySelector('#signup-email')
        .value)) {
        switchElementContent('#email-tip div', '邮箱格式错误')
        return false
    }
    switchElementContent('#email-tip div', '邮箱 / Email')
    return true
}</script>
    </div>
    <!-- Prefetch -->
    <div id="page-prefetch">
        
    </div>
</body>

</html>
<!-- EOF -->